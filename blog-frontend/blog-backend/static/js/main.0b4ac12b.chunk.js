(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{127:function(e,t,n){},130:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),l=n.n(c),u=n(7),o=n.n(u),i=n(11),s=n(19),m=n(28),p=n.n(m),f="/api/blogs",d=null,b=function(){var e=Object(i.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:d}},e.next=3,p.a.post("".concat(f,"/").concat(n),{comments:t},a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g={getAll:function(){return p.a.get(f).then((function(e){return e.data}))},setToken:function(e){d="bearer ".concat(e)},clearToken:function(){d=null},create:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:d}},e.next=3,p.a.post(f,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.put("".concat(f,"/").concat(t.id),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:d}},e.next=3,p.a.delete("".concat(f,"/").concat(t),n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addCommentToDB:b},E=n(62),v=n(88),h="",O=function(e,t){return function(){var n=Object(i.a)(o.a.mark((function n(a){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:h&&clearTimeout(h),a({type:"SET_NOTIFICATION",notification:e}),h=setTimeout((function(){a({type:"REMOVE_NOTIFICATION"})}),1e3*t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.notification;case"REMOVE_NOTIFICATION":return"";default:return e}},y=function(e){return function(){var t=Object(i.a)(o.a.mark((function t(n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.create(e);case 2:a=t.sent,n({type:"NEW_BLOG",data:a}),n(O("New blog added: ".concat(a.title)));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},w=function(e,t){return function(){var n=Object(i.a)(o.a.mark((function n(a){var r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Object(E.a)(Object(E.a)({},t),{},{likes:t.likes+1}),n.next=3,g.update(r);case 3:a({type:"LIKE",data:{id:e},blog:r});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},k=function(e){return{type:"REMOVE_BLOG",blog:e}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(v.a)(e),[t.data]);case"LIKE":var n=t.data.id;return e.map((function(e){return e.id!==n?e:t.blog}));case"REMOVE_BLOG":return e.filter((function(e){return e.id!==t.blog.id}));default:return e}},S=n(17),_=n(24),T=n(168),N=n(164),I=function(e){var t=e.comments;return t?r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",null,t.map((function(e){return r.a.createElement("li",{key:100*Math.random()},e)})))):r.a.createElement(r.a.Fragment,null)},L=function(e){var t=e.blog,n=Object(a.useState)(!1),c=Object(s.a)(n,2),l=c[0],u=c[1],m=Object(a.useState)(!0),p=Object(s.a)(m,2),f=p[0],d=p[1],b={display:l?"":"none"},E=f?"view":"hide",v=Object(S.b)(),h=function(){var e=Object(i.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,v(w(t.id,t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),e.prev=1,!window.confirm("Delete ".concat(t.title))){e.next=7;break}return e.next=5,g.remove(t.id);case 5:v(k(t)),v(O("".concat(t.title," deleted"),5));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),v(O("Remove denied",5));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"fixed"},r.a.createElement(_.b,{to:"/blogs/".concat(t.id)},t.title)," ",t.author,r.a.createElement("button",{onClick:function(){u(!l),d(!f)}},E),r.a.createElement("div",{style:b,className:"semi-toggleable"},r.a.createElement("p",null,t.url),r.a.createElement("p",{className:"likes"},"likes ",t.likes," ",r.a.createElement("button",{onClick:h,className:"likeButton"},"like")),r.a.createElement("p",null,t.user.name),r.a.createElement(N.a,{onClick:j},r.a.createElement(T.a,null)),r.a.createElement("br",null),"comments:",r.a.createElement(I,{comments:t.comments})))},C=n(169),A=n(131),B=n(170),F=n(171),R=function(e){var t=e.logout,n=e.setMessage,c=Object(S.b)(),l=Object(S.c)((function(e){return e.blogs})),u=Object(S.c)((function(e){return e.user}));return Object(a.useEffect)((function(){c(function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[c]),l?r.a.createElement("div",null,r.a.createElement(C.a,{variant:"subtitle1",align:"center",gutterBottom:!0},"blogs"),r.a.createElement("p",null,u.name," logged in ",t()),r.a.createElement(A.a,null,r.a.createElement(B.a,null,l.map((function(e){return r.a.createElement(F.a,null,r.a.createElement(L,{key:e.id,blog:e,setMessage:n}))}))))):r.a.createElement("div",null)},U=function(e){var t=Object(a.useState)(""),n=Object(s.a)(t,2),c=n[0],l=n[1],u=Object(a.useState)(""),m=Object(s.a)(u,2),p=m[0],f=m[1],d=Object(a.useState)(""),b=Object(s.a)(d,2),g=b[0],E=b[1],v=Object(S.b)(),h=function(){var t=Object(i.a)(o.a.mark((function t(n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),a={title:g,author:p,url:c},e.blogFormRef.current.toggleVisibility();try{v(y(a))}catch(r){v(O("blog add failed"))}E(""),f(""),l("");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return null===e.user?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"create new blog"),r.a.createElement("form",{onSubmit:h},r.a.createElement("div",null,"title",r.a.createElement("input",{id:"title",type:"text",value:g,name:"Title",onChange:function(e){var t=e.target;return E(t.value)}})),r.a.createElement("div",null,"author",r.a.createElement("input",{id:"author",type:"text",value:p,name:"Author",onChange:function(e){var t=e.target;return f(t.value)}})),r.a.createElement("div",null,"url",r.a.createElement("input",{id:"url",type:"text",value:c,name:"Url",onChange:function(e){var t=e.target;return l(t.value)}})),r.a.createElement("button",{id:"createButton",type:"submit"},"create")))},V=n(63),D={login:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},G=function(e){return{type:"SET_USER",user:e}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"SET_USER"===t.type?t.user:e},W=n(16),z=n(30),P=n.n(z),J=n(83),K=n.n(J),q=n(172),H=n(173),Q=n(186),X=n(182),Y=n(174),Z=n(185),$=n(183),ee=function(e,t,n){var r=Object(a.useState)(""),c=Object(s.a)(r,2),l=c[0],u=c[1];return{id:e,type:t,name:n,value:l,onChange:function(e){u(e.target.value)},setValue:u}},te=function(){var e=ee("username","text","Username"),t=e.setValue,n=Object(V.a)(e,["setValue"]),c=ee("password","password","Password"),l=c.setValue,u=Object(V.a)(c,["setValue"]),m=Object(S.b)(),p=Object(W.f)(),f=Object(a.useState)(!1),d=Object(s.a)(f,2),b=d[0],E=d[1],v=function(){var e=Object(i.a)(o.a.mark((function e(a){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,D.login({username:n.value,password:u.value});case 4:r=e.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(r)),g.setToken(r.token),m(G(r)),t(""),l(""),E(!0),setTimeout((function(){E(!1),p.push("/blogs")}),2e3),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),m(O("Wrong credentials",5));case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,{component:"main",maxWidth:"xs"},r.a.createElement(H.a,null),r.a.createElement("div",{style:{marginTop:"100px"}},r.a.createElement(C.a,{component:"h1",variant:"h5",style:{marginLeft:"23%"}},"log in to application"),r.a.createElement(Q.a,{className:P.a.avatar},r.a.createElement(K.a,null)),r.a.createElement("form",{onSubmit:v,noValidate:!0},r.a.createElement(X.a,Object.assign({margin:"normal",required:!0,className:P.a.tf,fullWidth:!0,id:"username",variant:"filled",label:"Username",name:"username",autoComplete:"email",autoFocus:!0,InputLabelProps:{className:P.a.floatingLabelFocusStyle}},n)),r.a.createElement(X.a,Object.assign({margin:"normal",required:!0,className:P.a.tf,fullWidth:!0,name:"password",variant:"filled",label:"Password",type:"password",id:"password",autoComplete:"current-password",InputLabelProps:{className:P.a.floatingLabelFocusStyle}},u)),r.a.createElement(Y.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",id:"login-button",className:P.a.submit},"Login")))),r.a.createElement(Z.a,{open:b},r.a.createElement($.a,{elevation:6,variant:"filled",severity:"success"},"Login Successful")))},ne=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(s.a)(n,2),l=c[0],u=c[1],o={display:l?"none":""},i={display:l?"":"none"},m=function(){u(!l)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:m}})),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement("button",{onClick:m},e.buttonLabel)),r.a.createElement("div",{style:i,className:"toggleableContent"},e.children,r.a.createElement("button",{onClick:m},"cancel")))})),ae=(n(127),function(){return p.a.get("/api/users").then((function(e){return e.data}))}),re=n(175),ce=n(176),le=n(177),ue=n(178),oe=n(179),ie=function(e){var t=e.users;e.setUsers;return r.a.createElement(r.a.Fragment,null,r.a.createElement(re.a,null,r.a.createElement(ce.a,null,r.a.createElement(le.a,null,r.a.createElement(ue.a,null,r.a.createElement(oe.a,null),r.a.createElement(oe.a,null,"number of blogs created")),t.map((function(e){return r.a.createElement(ue.a,{key:e.id},r.a.createElement(oe.a,null,r.a.createElement(_.b,{to:"/users/".concat(e.id)},e.name)),r.a.createElement(oe.a,null,e.blogs.length))}))))))},se=n(180),me=n(181),pe=function(){var e={paddingRight:3};return r.a.createElement(se.a,{style:{backgroundColor:"#8583af"},position:"static"},r.a.createElement(me.a,null,r.a.createElement(N.a,{edge:"start",color:"inherit","aria-label":"menu"}),r.a.createElement(Y.a,{style:{backgroundColor:"#c297c7",padding:"10px 10px",fontSize:"15px"},color:"inherit"},r.a.createElement(_.b,{href:"#",style:e,to:"/blogs"},"blogs")),r.a.createElement(Y.a,{style:{backgroundColor:"#c297c7",padding:"10px 10px",fontSize:"15px"},color:"inherit"},r.a.createElement(_.b,{style:e,to:"/users"},"users"))))},fe=function(e){var t=e.linkedUser;return t?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,t.name),r.a.createElement("h2",null,"added blogs"),r.a.createElement("ul",null,t.blogs.map((function(e){return r.a.createElement("li",null,e.title)})))):r.a.createElement(r.a.Fragment,null,"...Loading")},de=function(e){var t=e.linkedBlog,n=Object(S.b)(),c=Object(a.useState)(""),l=Object(s.a)(c,2),u=l[0],m=l[1],p=Object(a.useState)(t),f=Object(s.a)(p,2),d=f[0],b=f[1],E=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,n(w(d.id,d));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,g.addCommentToDB(u,d.id);case 3:n=e.sent,b(n),m("");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,d.title),r.a.createElement("div",null,d.url,r.a.createElement("br",null),d.likes," likes ",r.a.createElement("button",{onClick:E},"like"),r.a.createElement("br",null),"added by ",d.author),r.a.createElement("br",null),"comments:",r.a.createElement("form",{onSubmit:v},r.a.createElement("input",{value:u,onChange:function(e){m(e.target.value)}}),r.a.createElement("button",{type:"submit"},"add comment")),r.a.createElement(I,{comments:d.comments}))},be=function(e){var t=e.message;return null===t?null:r.a.createElement("div",{className:"error"},t)},ge=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],l=Object(S.c)((function(e){return e.notification})),u=Object(S.c)((function(e){return e.user})),m=Object(S.c)((function(e){return e.blogs})),p=Object(a.useRef)(),f=Object(S.b)(),d=Object(W.g)("/users/:id"),b=d?n.find((function(e){return e.id===d.params.id})):null,E=Object(W.g)("/blogs/:id"),v=E?m.find((function(e){return e.id===E.params.id})):null;console.log("BLOG MATCH",E),console.log("BLOGS",m),console.log("USER",u),console.log("LINKED BLOG",v),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);f(G(t)),g.setToken(t.token)}console.log(m)}),[f]),Object(a.useEffect)((function(){var e=!0;return function(){var t=Object(i.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ae();case 2:n=t.sent,e&&c(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()().then(),function(){return e=!1}}),[]);return r.a.createElement("div",null,r.a.createElement(be,{message:l}),r.a.createElement(pe,null),null===u&&r.a.createElement(te,null),r.a.createElement(W.c,null,r.a.createElement(W.a,{path:"/blogs/:id"},r.a.createElement(de,{linkedBlog:v})),r.a.createElement(W.a,{path:"/blogs"},r.a.createElement("div",null,null!==u&&r.a.createElement(R,{logout:function(){return r.a.createElement("button",{onClick:function(e){e.preventDefault(),window.localStorage.removeItem("loggedBlogAppUser"),f(G(null)),g.clearToken()}},"logout")}}),null!==u&&r.a.createElement("div",null,r.a.createElement(ne,{buttonLabel:"create new blog",ref:p},r.a.createElement(U,{user:u,blogFormRef:p}))))),r.a.createElement(W.a,{path:"/users/:id"},r.a.createElement(fe,{linkedUser:b})),r.a.createElement(W.a,{path:"/users"},null!==u&&r.a.createElement(ie,{users:n,setUsers:c})),r.a.createElement(W.a,{path:"/"},r.a.createElement("div",{className:P.a.centered},null!==u&&r.a.createElement("h1",{style:{textAlign:"center"}},"A Blogging App ")))))},Ee=n(84),ve=n(25),he=n(85),Oe=n(61),je=n(86),ye={key:"root",storage:n.n(je).a},we=Object(ve.combineReducers)({blogs:x,notification:j,user:M}),ke=Object(Oe.a)(ye,we),xe=Object(ve.createStore)(ke,Object(Ee.composeWithDevTools)(Object(ve.applyMiddleware)(he.a))),Se=Object(Oe.b)(xe),_e=xe,Te=n(87);l.a.render(r.a.createElement(S.a,{store:_e},r.a.createElement(Te.a,{loading:null,persistor:Se},r.a.createElement(_.a,null,r.a.createElement(ge,null)))),document.getElementById("root"))},30:function(e,t,n){e.exports={centered:"App_centered__1ermP",paper:"App_paper__Tg5o7",avatar:"App_avatar__2hEeV",tf:"App_tf__2B1F4",floatingLabelFocusStyle:"App_floatingLabelFocusStyle__2Ainb",submit:"App_submit__QRL9_"}},95:function(e,t,n){e.exports=n(130)}},[[95,1,2]]]);
//# sourceMappingURL=main.0b4ac12b.chunk.js.map